name: Test
on:
  push:

env:
  COMPOSER_ROOT_VERSION: "dev-trunk"

jobs:
  test:
    name: Test ${{ matrix.os }}
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ ubuntu-22.04, ubuntu-24.04 ]
    steps:
      - uses: actions/checkout@v4

      - name: Setup PHP
        uses: shivammathur/setup-php@verbose
        with:
          php-version: 7.0
          ini-values: error_reporting=E_ALL, display_errors=On, zend.assertions=1
          tools: composer:2.2.24
          extensions: mysql, imagick
          coverage: none

      - name: Configure composer
        run: |
          composer config --global github-protocols https
          composer config --global use-github-api false

      - name: Versions
        run: |
          php --version
          composer --version

      - name: Install
        run: |
          composer update

