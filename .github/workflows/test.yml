name: Test
on:
  push:

jobs:
  job:
    name: Test lots of files
    runs-on: ubuntu-latest
    steps:
      - run: |
          for (( i=0; i<1024; i++ )); do
            echo "-- $i --"
            SECONDS=0
            { time for (( j=0; j<1024; j++ )); do
              printf "%1024d" "$j" > "$i-$j.txt"
            done; } 2>&1
            echo $SECONDS
          done

  job2:
    name: Test lots of small files
    runs-on: ubuntu-latest
    steps:
      - run: |
          for (( i=0; i<1024; i++ )); do
            echo "-- $i --"
            SECONDS=0
            { time for (( j=0; j<1024; j++ )); do
              printf "x" > "$i-$j.txt"
            done; } 2>&1
            echo $SECONDS
          done

  job3:
    name: Test deleting lots of files
    runs-on: ubuntu-latest
    steps:
      - run: |
          for (( i=0; i<1024; i++ )); do
            echo "-- $i --"
            SECONDS=0
            { time for (( j=0; j<1024; j++ )); do
              printf "%1024d" "$j" > "$j.txt"
            done; } 2>&1
            time rm *.txt
            echo $SECONDS
          done

  job4:
    name: Test fewer big files
    runs-on: ubuntu-latest
    steps:
      - run: |
          for (( i=0; i<1024; i++ )); do
            echo "-- $i --"
            SECONDS=0
            { time for (( j=0; j<1024; j++ )); do
              printf "%1024d" "$j" >> "$i.txt"
            done; } 2>&1
            echo $SECONDS
          done
